# 정규 표현식의 매칭 그룹

## 그룹 매칭의 필요성
정규 표현식은 단순히 텍스트 패턴을 찾는 것뿐만 아니라, 필요한 정보를 추출하여 추가적인 처리를 할 수 있는 강력한 도구입니다. 특정 패턴의 일부만 추출하거나, 구조화된 데이터에서 특정 부분만 가져와야 할 때 그룹 매칭 기능이 유용합니다.

## 캡처 그룹 소개
정규 표현식에서는 **소괄호(parentheses)** `()`를 사용하여 문자의 그룹을 정의하고 캡처할 수 있습니다.

### 캡처 그룹 문법
- **(패턴)**: 소괄호 안의 패턴과 매칭되는 부분을 별도의 그룹으로 캡처
- 여러 그룹을 만들 수 있으며, 각 그룹은 왼쪽에서 오른쪽으로 번호가 매겨짐
- 캡처된 그룹은 나중에 참조 가능 (정규 표현식 엔진이나 프로그래밍 언어의 API를 통해)

## 캡처 그룹의 동작 방식
캡처 그룹은 일반적인 패턴 매칭과 함께 작동하면서, 매칭된 부분 중 특정 부분만 별도로 추출합니다.

### 기본 원리
1. 정규 표현식 패턴이 텍스트와 매칭됨
2. 매칭된 전체 텍스트가 결과로 반환됨
3. 소괄호로 묶인 부분은 별도의 그룹으로 캡처되어 접근 가능

## 실제 사용 예시

### 파일 이름 추출
- **^(IMG\d+)\.png$**: PNG 이미지 파일에서 파일 이름만 추출 (확장자 제외)
  - "IMG123.png"에서 "IMG123" 부분만 캡처
- **^(report)(\d{4})(\d{2})(\d{2})\.pdf$**: 날짜 형식의 보고서 파일에서 날짜 부분 추출
  - "report20231115.pdf"에서 "report", "2023", "11", "15" 부분을 각각 캡처

### 개인 정보 추출
- **(\d{3})-(\d{3,4})-(\d{4})**: 전화번호에서 지역 코드, 국번, 개인 번호 추출
  - "010-1234-5678"에서 "010", "1234", "5678" 부분을 각각 캡처
- **([A-Za-z0-9._%+-]+)@([A-Za-z0-9.-]+\.[A-Z|a-z]{2,})**: 이메일 주소에서 계정명과 도메인 분리
  - "user@example.com"에서 "user"와 "example.com" 부분을 각각 캡처

### URL 파싱
- **https?://([^/]+)/(.*)**: URL에서 도메인과 경로 분리
  - "https://example.com/path/to/resource"에서 "example.com"과 "path/to/resource" 부분을 각각 캡처
- **^(https?)://([^:/]+)(?::(\d+))?(/.*)?$**: URL의 프로토콜, 도메인, 포트, 경로 추출
  - "https://example.com:8080/path"에서 "https", "example.com", "8080", "/path" 부분을 각각 캡처

## 중첩 그룹
소괄호는 중첩해서 사용할 수 있으며, 이를 통해 계층적인 데이터 추출이 가능합니다.

### 중첩 그룹 예시
- **((A)(B))**: "AB"를 매칭하면서, "AB", "A", "B" 세 개의 그룹으로 캡처
- **(\w+\s*=\s*(['"])(.*?)(\2))**: HTML/XML 속성 파싱
  - `class="container"` → "class="container"", "class", """, "container", """

## 비캡처 그룹
그룹화는 하되 캡처는 하지 않는 비캡처 그룹 문법도 있습니다.

### 비캡처 그룹 문법
- **(?:패턴)**: 소괄호 안에 `?:`를 추가하여 그룹화만 하고 캡처하지 않음
- 그룹의 개수를 줄여서 효율성을 높이고 코드를 간결하게 만듦

### 비캡처 그룹 예시
- **(?:https?|ftp)://(\w+\.\w+)**: 프로토콜은 그룹화만 하고 도메인만 캡처
  - "https://example.com"에서 "example.com" 부분만 캡처

## 그룹 참조
많은 정규 표현식 엔진에서는 캡처된 그룹을 같은 패턴 내에서 참조할 수 있는 방법을 제공합니다.

### 역참조(Backreference) 문법
- **\1, \2, ...**: 캡처된 첫 번째, 두 번째, ... 그룹을 참조
- 주로 반복되는 패턴이나 짝을 이루는 패턴을 찾을 때 유용

### 역참조 예시
- **(\w+)\s+\1**: 연속해서 반복되는 단어 찾기
  - "hello hello"에서 "hello hello" 전체가 매칭되고 "hello"가 캡처됨
- **(['"]).*?\1**: 같은 종류의 따옴표로 둘러싸인 문자열 찾기
  - `"example"` 또는 `'example'`과 매칭

## 실습 예제
다음 패턴들을 작성하고 어떻게 캡처 그룹이 동작하는지 확인해 보세요:

1. PDF 파일의 이름만 추출하는 패턴: `^(.*?)\.pdf$`
  - "report.pdf" → "report" 캡처
  - "document-v2.pdf" → "document-v2" 캡처

2. 날짜 형식에서 연, 월, 일을 각각 추출하는 패턴: `^(\d{4})-(\d{2})-(\d{2})$`
  - "2023-11-15" → "2023", "11", "15" 캡처

3. HTML 태그에서 태그 이름과 내용을 추출하는 패턴: `<(\w+)>(.*?)</\1>`
  - `<span>Hello</span>` → "span", "Hello" 캡처

## 고급 활용 기법
정규 표현식 캡처 그룹은 다양한 프로그래밍 언어와 도구에서 활용됩니다:

### 프로그래밍 언어에서의 활용
1. **치환(Replace)**: 캡처된 그룹을 사용하여 텍스트 변환
   - `(\d{4})-(\d{2})-(\d{2})` → `$2/$3/$1` (날짜 형식 변환: "2023-11-15" → "11/15/2023")

2. **구문 분석(Parsing)**: 구조화된 데이터에서 특정 정보 추출
   - 로그 파일에서 날짜, 시간, 메시지 레벨, 내용 추출

3. **데이터 검증(Validation)**: 입력 데이터의 형식 확인 및 유효한 부분 추출
   - 입력된 전화번호에서 국가 코드, 지역 코드, 번호 부분 분리 및 검증

## 주의사항
1. 너무 많은 캡처 그룹을 사용하면 복잡성이 증가하고 성능이 저하됨
2. 필요하지 않은 경우 비캡처 그룹 (?:패턴)을 사용하는 것이 좋음
3. 그룹 참조 번호는 정규 표현식 엔진마다 다를 수 있으니 주의 필요
